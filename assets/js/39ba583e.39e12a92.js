"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8989],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(n),m=o,g=u["".concat(s,".").concat(m)]||u[m]||d[m]||i;return n?r.createElement(g,a(a({ref:t},p),{},{components:n})):r.createElement(g,a({ref:t},p))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[u]="string"==typeof e?e:o,a[1]=c;for(var l=2;l<i;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},319:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=n(7462),o=(n(7294),n(3905));const i={title:"client-go \u6e90\u7801\u5206\u6790\uff084\uff09 - ClientSet\u5ba2\u6237\u7aef \u548c DynamicClient\u5ba2\u6237\u7aef",readmore:!0,date:new Date("2022-11-25T20:24:49.000Z"),categories:"\u4e91\u539f\u751f",tags:["client-go"]},a=void 0,c={unversionedId:"cloud-native/client-go/client-go-04",id:"cloud-native/client-go/client-go-04",title:"client-go \u6e90\u7801\u5206\u6790\uff084\uff09 - ClientSet\u5ba2\u6237\u7aef \u548c DynamicClient\u5ba2\u6237\u7aef",description:"\u672c\u7bc7\u7684\u4e3b\u9898\u662f\u5ba2\u6237\u7aefClientSet\u3002ClientSet\u548cDynamicClient\u7684\u4f18\u7f3a\u70b9\u6b63\u597d\u4e92\u6362\u3002ClientSet\u53ea\u80fd\u64cd\u4f5c\u5185\u7f6e\u7684\u8d44\u6e90\u5bf9\u8c61\uff0cDynamicClient\u4e0d\u4ec5\u53ef\u4ee5\u64cd\u4f5c\u5185\u7f6e\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u64cd\u4f5cCRD\uff1bClientSet\u6709\u7c7b\u578b\u68c0\u67e5\uff0cDynamicClient\u6ca1\u6709\u3002",source:"@site/docs/cloud-native/client-go/client-go-04.md",sourceDirName:"cloud-native/client-go",slug:"/cloud-native/client-go/client-go-04",permalink:"/docs/cloud-native/client-go/client-go-04",draft:!1,editUrl:"https://github.com/backendcloud/docusaurus/tree/main/docs/cloud-native/client-go/client-go-04.md",tags:[{label:"client-go",permalink:"/docs/tags/client-go"}],version:"current",frontMatter:{title:"client-go \u6e90\u7801\u5206\u6790\uff084\uff09 - ClientSet\u5ba2\u6237\u7aef \u548c DynamicClient\u5ba2\u6237\u7aef",readmore:!0,date:"2022-11-25T20:24:49.000Z",categories:"\u4e91\u539f\u751f",tags:["client-go"]},sidebar:"tutorialSidebar",previous:{title:"client-go \u6e90\u7801\u5206\u6790\uff083\uff09 - rest\u6a21\u5757",permalink:"/docs/cloud-native/client-go/client-go-03"},next:{title:"client-go \u6e90\u7801\u5206\u6790\uff085\uff09 - informer\u673a\u5236\u4e2d\u7684\u672c\u5730\u5b58\u50a8indexer",permalink:"/docs/cloud-native/client-go/client-go-05"}},s={},l=[],p={toc:l},u="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"\u672c\u7bc7\u7684\u4e3b\u9898\u662f\u5ba2\u6237\u7aefClientSet\u3002ClientSet\u548cDynamicClient\u7684\u4f18\u7f3a\u70b9\u6b63\u597d\u4e92\u6362\u3002ClientSet\u53ea\u80fd\u64cd\u4f5c\u5185\u7f6e\u7684\u8d44\u6e90\u5bf9\u8c61\uff0cDynamicClient\u4e0d\u4ec5\u53ef\u4ee5\u64cd\u4f5c\u5185\u7f6e\u7684\u8d44\u6e90\u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u64cd\u4f5cCRD\uff1bClientSet\u6709\u7c7b\u578b\u68c0\u67e5\uff0cDynamicClient\u6ca1\u6709\u3002"),(0,o.kt)("p",null,"\u4e0b\u9762\u662f\u4e00\u4e2a\u8c03\u7528ClientSet\uff0c\u67e5\u8be2default namespace\u4e0b\u6240\u6709pod\u7684\u4f8b\u5b50\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "context"\n    "fmt"\n\n    apiv1 "k8s.io/api/core/v1"\n    metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"\n    "k8s.io/client-go/kubernetes"\n    "k8s.io/client-go/tools/clientcmd"\n)\n\nfunc main() {\n    // \u52a0\u8f7dkubeconfig\u6587\u4ef6\uff0c\u751f\u6210config\u5bf9\u8c61\n    config, err := clientcmd.BuildConfigFromFlags("", "C:\\\\Users\\\\hanwei\\\\config")\n    if err != nil {\n        panic(err)\n    }\n\n    // kubernetes.NewForConfig\u901a\u8fc7config\u5b9e\u4f8b\u5316ClientSet\u5bf9\u8c61\n    clientset, err := kubernetes.NewForConfig(config)\n    if err != nil {\n        panic(err)\n    }\n\n    //\u8bf7\u6c42core\u6838\u5fc3\u8d44\u6e90\u7ec4v1\u8d44\u6e90\u7248\u672c\u4e0b\u7684Pods\u8d44\u6e90\u5bf9\u8c61\n    podClient := clientset.CoreV1().Pods(apiv1.NamespaceDefault)\n    // \u8bbe\u7f6e\u9009\u9879\n    list, err := podClient.List(context.TODO(), metav1.ListOptions{Limit: 500})\n    if err != nil {\n        panic(err)\n    }\n\n    for _, d := range list.Items {\n        fmt.Printf("NAMESPACE: %v \\t NAME:%v \\t STATUS: %+v\\n", d.Namespace, d.Name, d.Status.Phase)\n    }\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"GOROOT=C:\\go\\go1.19 #gosetup\nGOPATH=C:\\Users\\hanwei\\go #gosetup\nC:\\go\\go1.19\\bin\\go.exe build -o C:\\Users\\hanwei\\AppData\\Local\\Temp\\GoLand\\___2go_build_lab.exe lab #gosetup\nC:\\Users\\hanwei\\AppData\\Local\\Temp\\GoLand\\___2go_build_lab.exe\nNAMESPACE: default       NAME:cdi-upload-windows-2003-001        STATUS: Running\nNAMESPACE: default       NAME:tomcat-deployment-5b689c848f-2jprs         STATUS: Running\nNAMESPACE: default       NAME:virt-launcher-bc-2003-0907-001-vkd8f       STATUS: Running\nNAMESPACE: default       NAME:virt-launcher-test-sg-111-lc9kf    STATUS: Running\nNAMESPACE: default       NAME:virt-launcher-test-sg-v98xt        STATUS: Running\nNAMESPACE: default       NAME:virt-launcher-test-vpc-hxkpx       STATUS: Running\nNAMESPACE: default       NAME:virt-launcher-vm-centos-jphml      STATUS: Running\n\nProcess finished with the exit code 0\n")),(0,o.kt)("p",null,"\u4e0a\u9762\u7684main\u65b9\u6cd5\u6838\u5fc3\u5c31\u662f\u8fd9\u4e24\u53e5\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"    //\u8bf7\u6c42core\u6838\u5fc3\u8d44\u6e90\u7ec4v1\u8d44\u6e90\u7248\u672c\u4e0b\u7684Pods\u8d44\u6e90\u5bf9\u8c61\n    podClient := clientset.CoreV1().Pods(apiv1.NamespaceDefault)\n    // \u8bbe\u7f6e\u9009\u9879\n    list, err := podClient.List(context.TODO(), metav1.ListOptions{Limit: 500})\n")),(0,o.kt)("p",null,"main\u65b9\u6cd5\u4e2d\u7684 clientset.CoreV1() \u8c03\u7528\u4e86\u4e0b\u9762\u7684\u65b9\u6cd5\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"func (c *Clientset) CoreV1() corev1.CoreV1Interface {\n    return c.coreV1\n}\n")),(0,o.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u8fd4\u56de\u7684\u662fcorev1\u5ba2\u6237\u7aef\uff0c\u503c\u7c7b\u578b\u662f*corev1.CoreV1Client\u7c7b\u578b\uff0c\u662fcorev1.CoreV1Interface\u63a5\u53e3\u7c7b\u578b\u7684\u5177\u4f53\u7c7b\u578b\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"type PodsGetter interface {\n    Pods(namespace string) PodInterface\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"func (c *CoreV1Client) Pods(namespace string) PodInterface {\n    return newPods(c, namespace)\n}\n")),(0,o.kt)("p",null,"\u4e0a\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51faCoreV1Client\u5b9e\u73b0\u4e86PodsGetter\u63a5\u53e3\u7684\u5168\u90e8\u65b9\u6cd5\uff0cclientset.CoreV1().Pods(apiv1.NamespaceDefault)\u6240\u4ee5\u4f1a\u914d\u5230PodsGetter\u63a5\u53e3\u7684Pods\u65b9\u6cd5\uff0c\u518d\u5339\u914d\u5230\u5177\u4f53\u7684func (c *CoreV1Client) Pods\u65b9\u6cd5\uff0c\u5e76\u4f20\u5165namespace\u53c2\u6570\u3002"),(0,o.kt)("p",null,"newPods \u51fd\u6570\u4f1a\u6784\u9020pods\u7ed3\u6784\u4f53\uff0c\u5e76\u5c06\u51fd\u6570\u7684\u5f62\u53c2\u4e00\u4e2a\u662f corev1 \u5ba2\u6237\u7aef \u7684 RESTClient()\u65b9\u6cd5\uff0c\u5c31\u662f\u4e0a\u7bc7\u8bb2\u5230\u7684restclient\u5ba2\u6237\u7aef\uff0c\u4e00\u4e2a\u662fnamespace\uff0c(c *CoreV1Client, namespace string)\u5206\u522b\u653e\u8fdbpods\u7ed3\u6784\u4f53\u7684\u4e24\u4e2a\u5c5e\u6027\u4e2d\u3002\u800cpods\u7ed3\u6784\u4f53\u53c8\u5b9e\u73b0\u4e86PodInterface\u63a5\u53e3\u7684List\u65b9\u6cd5\u3002"),(0,o.kt)("p",null,"main\u65b9\u6cd5\u4e2d\u7684 clientset.CoreV1().Pods(apiv1.NamespaceDefault) \u8fd4\u56de\u7684\u662fPodInterface\u63a5\u53e3\u3002main\u65b9\u6cd5\u4e2d\u7684\u4e0b\u4e00\u53e5\u4e2d podClient.List \u5b9e\u9645\u8c03\u7528\u7684\u5c31\u662f func (c ",(0,o.kt)("em",{parentName:"p"},"pods) List(ctx context.Context, opts metav1.ListOptions) (result "),"v1.PodList, err error) \u65b9\u6cd5\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"func newPods(c *CoreV1Client, namespace string) *pods {\n    return &pods{\n        client: c.RESTClient(),\n        ns:     namespace,\n    }\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"type pods struct {\n    client rest.Interface\n    ns     string\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},"type PodInterface interface {\n    Create(ctx context.Context, pod *v1.Pod, opts metav1.CreateOptions) (*v1.Pod, error)\n    Update(ctx context.Context, pod *v1.Pod, opts metav1.UpdateOptions) (*v1.Pod, error)\n    UpdateStatus(ctx context.Context, pod *v1.Pod, opts metav1.UpdateOptions) (*v1.Pod, error)\n    Delete(ctx context.Context, name string, opts metav1.DeleteOptions) error\n    DeleteCollection(ctx context.Context, opts metav1.DeleteOptions, listOpts metav1.ListOptions) error\n    Get(ctx context.Context, name string, opts metav1.GetOptions) (*v1.Pod, error)\n    List(ctx context.Context, opts metav1.ListOptions) (*v1.PodList, error)\n    Watch(ctx context.Context, opts metav1.ListOptions) (watch.Interface, error)\n    Patch(ctx context.Context, name string, pt types.PatchType, data []byte, opts metav1.PatchOptions, subresources ...string) (result *v1.Pod, err error)\n    Apply(ctx context.Context, pod *corev1.PodApplyConfiguration, opts metav1.ApplyOptions) (result *v1.Pod, err error)\n    ApplyStatus(ctx context.Context, pod *corev1.PodApplyConfiguration, opts metav1.ApplyOptions) (result *v1.Pod, err error)\n    UpdateEphemeralContainers(ctx context.Context, podName string, pod *v1.Pod, opts metav1.UpdateOptions) (*v1.Pod, error)\n\n    PodExpansion\n}\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func (c *pods) List(ctx context.Context, opts metav1.ListOptions) (result *v1.PodList, err error) {\n    var timeout time.Duration\n    if opts.TimeoutSeconds != nil {\n        timeout = time.Duration(*opts.TimeoutSeconds) * time.Second\n    }\n    result = &v1.PodList{}\n    err = c.client.Get().\n        Namespace(c.ns).\n        Resource("pods").\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Timeout(timeout).\n        Do(ctx).\n        Into(result)\n    return\n}\n')),(0,o.kt)("p",null,"\u5b9e\u9645\u4e0a func (c ",(0,o.kt)("em",{parentName:"p"},"pods) List(ctx context.Context, opts metav1.ListOptions) (result "),"v1.PodList, err error) \u65b9\u6cd5\u5c31\u662f\u8c03\u7528\u4e0a\u9762\u8bb2\u5230\u7684 restclient \u5ba2\u6237\u7aef\u3002 \u53c2\u8003 {% post_link client-go-3 %}"),(0,o.kt)("p",null,"\u4e0a\u9762\u662fclientset\u67e5\u8be2pod list\u7684\uff0c\u4e0b\u9762\u7684\u5220\u9664\uff0c\u521b\u5efa\uff0c\u90fd\u662f\u8c03\u7528\u7684restclient\u5ba2\u6237\u7aef\u5b9e\u73b0\u7684\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func (c *pods) Delete(ctx context.Context, name string, opts metav1.DeleteOptions) error {\n    return c.client.Delete().\n        Namespace(c.ns).\n        Resource("pods").\n        Name(name).\n        Body(&opts).\n        Do(ctx).\n        Error()\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func (c *pods) Create(ctx context.Context, pod *v1.Pod, opts metav1.CreateOptions) (result *v1.Pod, err error) {\n    result = &v1.Pod{}\n    err = c.client.Post().\n        Namespace(c.ns).\n        Resource("pods").\n        VersionedParams(&opts, scheme.ParameterCodec).\n        Body(pod).\n        Do(ctx).\n        Into(result)\n    return\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'type Pod struct {\n    metav1.TypeMeta `json:",inline"`\n    // Standard object\'s metadata.\n    // More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata\n    // +optional\n    metav1.ObjectMeta `json:"metadata,omitempty" protobuf:"bytes,1,opt,name=metadata"`\n\n    // Specification of the desired behavior of the pod.\n    // More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#spec-and-status\n    // +optional\n    Spec PodSpec `json:"spec,omitempty" protobuf:"bytes,2,opt,name=spec"`\n\n    // Most recently observed status of the pod.\n    // This data may not be up to date.\n    // Populated by the system.\n    // Read-only.\n    // More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#spec-and-status\n    // +optional\n    Status PodStatus `json:"status,omitempty" protobuf:"bytes,3,opt,name=status"`\n}\n')),(0,o.kt)("p",null,"DynamicClient\u662f\u4e00\u79cd\u52a8\u6001\u5ba2\u6237\u7aef\uff0c\u5b83\u53ef\u4ee5\u5bf9\u4efb\u610fKubernetes\u8d44\u6e90\u8fdb\u884cRESTful\u64cd\u4f5c\uff0c\u5305\u62ecCRD\u81ea\u5b9a\u4e49\u8d44\u6e90\u3002DynamicClient\u4e0eClientSet\u64cd\u4f5c\u7c7b\u4f3c\uff0c\u540c\u6837\u5c01\u88c5\u4e86RESTClient\uff0c\u540c\u6837\u63d0\u4f9b\u4e86Create\u3001Update\u3001Delete\u3001Get\u3001List\u3001Watch\u3001Patch\u7b49\u65b9\u6cd5\u3002DynamicClient\u4e0eClientSet\u6700\u5927\u7684\u4e0d\u540c\u4e4b\u5904\u662f\uff0cClientSet\u4ec5\u80fd\u8bbf\u95eeKubernetes\u81ea\u5e26\u7684\u8d44\u6e90\uff08\u5373\u5ba2\u6237\u7aef\u96c6\u5408\u5185\u7684\u8d44\u6e90\uff09\uff0c\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95eeCRD\u81ea\u5b9a\u4e49\u8d44\u6e90\u3002ClientSet\u9700\u8981\u9884\u5148\u5b9e\u73b0\u6bcf\u79cdResource\u548cVersion\u7684\u64cd\u4f5c\uff0c\u5176\u5185\u90e8\u7684\u6570\u636e\u90fd\u662f\u7ed3\u6784\u5316\u6570\u636e\uff08\u5373\u5df2\u77e5\u6570\u636e\u7ed3\u6784\uff09\u3002\u800cDynamicClient\u5185\u90e8\u5b9e\u73b0\u4e86Unstructured\uff0c\u7528\u4e8e\u5904\u7406\u975e\u7ed3\u6784\u5316\u6570\u636e\u7ed3\u6784\uff08\u5373\u65e0\u6cd5\u63d0\u524d\u9884\u77e5\u6570\u636e\u7ed3\u6784\uff09\uff0c\u8fd9\u4e5f\u662fDynamicClient\u80fd\u591f\u5904\u7406CRD\u81ea\u5b9a\u4e49\u8d44\u6e90\u7684\u5173\u952e\u3002"),(0,o.kt)("p",null,"\u6ce8\u610f\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"DynamicClient\u83b7\u5f97\u7684\u6570\u636e\u90fd\u662f\u4e00\u4e2aobject\u7c7b\u578b\u3002\u5b58\u7684\u65f6\u5019\u662f unstructured"),(0,o.kt)("li",{parentName:"ul"},"DynamicClient\u4e0d\u662f\u7c7b\u578b\u5b89\u5168\u7684\uff0c\u56e0\u6b64\u5728\u8bbf\u95eeCRD\u81ea\u5b9a\u4e49\u8d44\u6e90\u65f6\u9700\u8981\u7279\u522b\u6ce8\u610f\u3002\u4f8b\u5982\uff0c\u5728\u64cd\u4f5c\u6307\u9488\u4e0d\u5f53\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u3002")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "context"\n    "fmt"\n\n    apiv1 "k8s.io/api/core/v1"\n    corev1 "k8s.io/api/core/v1"\n    metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"\n\n    "k8s.io/apimachinery/pkg/runtime"\n    "k8s.io/apimachinery/pkg/runtime/schema"\n    "k8s.io/client-go/dynamic"\n    "k8s.io/client-go/tools/clientcmd"\n)\n\nfunc main() {\n    // \u52a0\u8f7dkubeconfig\u6587\u4ef6\uff0c\u751f\u6210config\u5bf9\u8c61\n    config, err := clientcmd.BuildConfigFromFlags("", "C:\\\\Users\\\\hanwei\\\\config")\n    if err != nil {\n        panic(err)\n    }\n\n    // dynamic.NewForConfig\u51fd\u6570\u901a\u8fc7config\u5b9e\u4f8b\u5316dynamicClient\u5bf9\u8c61\n    dynamicClient, err := dynamic.NewForConfig(config)\n    if err != nil {\n        panic(err)\n    }\n\n    // \u901a\u8fc7schema.GroupVersionResource\u8bbe\u7f6e\u8bf7\u6c42\u7684\u8d44\u6e90\u7248\u672c\u548c\u8d44\u6e90\u7ec4\uff0c\u8bbe\u7f6e\u547d\u540d\u7a7a\u95f4\u548c\u8bf7\u6c42\u53c2\u6570,\u5f97\u5230unstructured.UnstructuredList\u6307\u9488\u7c7b\u578b\u7684PodList\n    gvr := schema.GroupVersionResource{Version: "v1", Resource: "pods"}\n    unstructObj, err := dynamicClient.Resource(gvr).Namespace(apiv1.NamespaceDefault).List(context.TODO(), metav1.ListOptions{Limit: 500})\n    if err != nil {\n        panic(err)\n    }\n\n    // \u901a\u8fc7runtime.DefaultUnstructuredConverter\u51fd\u6570\u5c06unstructured.UnstructuredList\u8f6c\u4e3aPodList\u7c7b\u578b\n    podList := &corev1.PodList{}\n    err = runtime.DefaultUnstructuredConverter.FromUnstructured(unstructObj.UnstructuredContent(), podList)\n    if err != nil {\n        panic(err)\n    }\n\n    for _, d := range podList.Items {\n        fmt.Printf("NAMESPACE: %v NAME:%v \\t STATUS: %+v\\n", d.Namespace, d.Name, d.Status.Phase)\n    }\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"GOROOT=C:\\go\\go1.19 #gosetup\nGOPATH=C:\\Users\\hanwei\\go #gosetup\nC:\\go\\go1.19\\bin\\go.exe build -o C:\\Users\\hanwei\\AppData\\Local\\Temp\\GoLand\\___4go_build_lab.exe lab #gosetup\nC:\\Users\\hanwei\\AppData\\Local\\Temp\\GoLand\\___4go_build_lab.exe\nNAMESPACE: default NAME:cdi-upload-windows-2003-001      STATUS: Running\nNAMESPACE: default NAME:hp-volume-7lvp4          STATUS: Running\nNAMESPACE: default NAME:tomcat-deployment-5b689c848f-2jprs       STATUS: Running\nNAMESPACE: default NAME:virt-launcher-bc-2003-0907-001-vkd8f     STATUS: Running\nNAMESPACE: default NAME:virt-launcher-test-sg-111-lc9kf          STATUS: Running\nNAMESPACE: default NAME:virt-launcher-test-sg-v98xt      STATUS: Running\nNAMESPACE: default NAME:virt-launcher-test-snapshot-v-z52fv      STATUS: Running\nNAMESPACE: default NAME:virt-launcher-test-vpc-q8rwz     STATUS: Running\nNAMESPACE: default NAME:virt-launcher-vm-centos-q5zq5    STATUS: Running\n\nProcess finished with the exit code 0\n")),(0,o.kt)("p",null,"\u548cClientSet\u5ba2\u6237\u7aef\u4e00\u6837\uff0c\u8c03\u7528\u7684ResetClient\u5ba2\u6237\u7aef\u3002\u4e0d\u540c\u7684\u662f\u5c06response body\u7684\u6570\u636e\u8f6c\u6210\u975e\u7ed3\u6784\u5316\u7684\u6570\u636e\u4f53\u8fd4\u56de\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func (c *dynamicResourceClient) List(ctx context.Context, opts metav1.ListOptions) (*unstructured.UnstructuredList, error) {\n    result := c.client.client.Get().AbsPath(c.makeURLSegments("")...).SpecificallyVersionedParams(&opts, dynamicParameterCodec, versionV1).Do(ctx)\n    if err := result.Error(); err != nil {\n        return nil, err\n    }\n    retBytes, err := result.Raw()\n    if err != nil {\n        return nil, err\n    }\n    uncastObj, err := runtime.Decode(unstructured.UnstructuredJSONScheme, retBytes)\n    if err != nil {\n        return nil, err\n    }\n    if list, ok := uncastObj.(*unstructured.UnstructuredList); ok {\n        return list, nil\n    }\n\n    list, err := uncastObj.(*unstructured.Unstructured).ToList()\n    if err != nil {\n        return nil, err\n    }\n    return list, nil\n}\n')),(0,o.kt)("p",null,"\u5728\u8c03\u7528 runtime.DefaultUnstructuredConverter.FromUnstructured \u5c06\u4e0a\u9762\u7684\u975e\u7ed3\u6784\u5316\u6570\u636e\u8f6c\u6362\u6210Kubernetes\u8d44\u6e90\u5bf9\u8c61\u6570\u636e\u7c7b\u578b\uff08\u4f7f\u7528encoding/json/Unmarshaler\u8fdb\u884c\u8f6c\u6362\uff0c\u82e5\u65e0\u6cd5\u901a\u8fc7\u4e0a\u8ff0\u65b9\u5f0f\u8f6c\u6362\uff0c\u7528\u53cd\u5c04\u673a\u5236\u8fdb\u884c\u8f6c\u6362\uff09\u3002"))}d.isMDXComponent=!0}}]);